(()=>{"use strict";var e,t={262:(e,t,r)=>{var n=r(294),o=r(935),a=r(975),i=r(797),u=r.n(i),c=r(122);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function v(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t&&y(e.prototype,t),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var b={onError:console.error},w=function(){function e(t){d(this,e),this.errorHandler=t}return g(e,[{key:"onError",value:function(){var e;(e=this.errorHandler).onError.apply(e,arguments)}},{key:"wrapPromise",value:function(e){var t=this;return e.catch((function(e){if(e instanceof Error)t.errorHandler.onError(e);else try{throw new Error("Promise rejected with reason "+(null==e?void 0:e.toString()))}catch(e){t.errorHandler.onError(e)}return Promise.reject(e)}))}},{key:"wrap",value:function(e){var t=this;return function(){try{return e.apply(void 0,arguments)}catch(e){throw t.errorHandler.onError(e),e}}}}]),e}(),E=n.createContext(new w(b)),x=function(){return(0,n.useContext)(E)},O=n.createContext([]),S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(a,e);var t,r,o=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=m(t);if(r){var o=m(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return v(this,e)});function a(e){var t;return d(this,a),(t=o.call(this,e)).state={error:null,errorInfo:null},t}return g(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?n.createElement(T,{error:this.state.error,details:this.state.errorInfo.componentStack}):this.props.children}}]),a}(n.Component);function C(e){var t=e.children,r=e.chainErrorHandler,o=s((0,n.useState)([]),2),a=o[0],i=o[1],u=(0,n.useMemo)((function(){return new w({onError:function(e){i((function(t){return[].concat(function(e){if(Array.isArray(e))return p(e)}(r=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||f(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e]);var r})),r&&r.onError(e)}})}),[r]);return n.createElement(O.Provider,{value:a},n.createElement(E.Provider,{value:u},t))}function j(e){var t=e.children,r=e.chainErrorHandler,o=s((0,n.useState)(),2),a=o[0],i=o[1],u=(0,n.useCallback)((function(e){if(null!=e&&e.length)return a?n.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,background:"white"}},n.createElement(P,{errors:e}),n.createElement("button",{onClick:function(){return i(!1)}},"X")):n.createElement("button",{style:{position:"absolute",bottom:0,right:0},onClick:function(){return i(!0)}},"Errors!")}),[a]);return n.createElement(C,{chainErrorHandler:r},t,n.createElement(O.Consumer,null,u))}function P(e){var t=e.errors;return n.createElement("div",{className:"errorLog"},t.map((function(e){return n.createElement(T,{error:e})})))}function T(e){var t=e.error,r=e.details;return null!=t&&t.stack||r?n.createElement("details",{className:"errorLogEntry"},n.createElement("summary",null,null==t?void 0:t.toString()),(null==t?void 0:t.stack)&&n.createElement("div",{className:"stackTrace"},null==t?void 0:t.stack),r&&n.createElement("div",{className:"details"},r)):n.createElement("div",{className:"errorLogEntry"},null==t?void 0:t.toString())}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k=function(e){return Array(e).fill().map((function(e,t){return t}))},R=function(e){return e},_=["deviceId"],N=["position"];function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var H={width:{ideal:4096,max:4096},height:{ideal:4096,max:4096}};function G(e){var t,r=e.constraints,o=e.onChange;return n.createElement("label",null,"Camera:",n.createElement(V,{value:null==r||null===(t=r.deviceId)||void 0===t?void 0:t.exact,onChange:function(e){o(e?function(t){return U(U({},t),{},{deviceId:{exact:e}})}:function(e){return e.deviceId,D(e,_)})}}))}function V(e){var t,r,o,a=e.value,i=e.onChange,u=x(),l={menu:function(e){return e.position,D(e,N)}},s=(r=(0,n.useState)({}),o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(r,o)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=s[0],p=s[1];return n.createElement(c.Z,{isSearchable:!1,isClearable:!0,loadOptions:function(e){var t=navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"==e.kind})).map((function(e){return{value:e.deviceId,label:e.label||e.deviceId}}))}));return u.wrapPromise(t.then((function(e){return p(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R;return e.reduce((function(e,n){return I(I({},e),{},M({},t(n),r(n)))}),{})}(e,(function(e){return e.value})))}))),t},defaultOptions:!0,value:{value:a,label:a?null===(t=f[a])||void 0===t?void 0:t.label:"Any"},onChange:function(e){return i(null==e?void 0:e.value)},styles:l})}var J=r(141),W=r(600),X=r(437),$=r(160),q=r(69),Z=r(162),z=r(754),K=r(948);function Y(e,t,r){return new z.Z(k(e).map((function(e){return k(t).map((function(t){return r(e,t)}))})))}function Q(e,t){return Y(e.rows,e.columns,(function(r,n){return r==n?t(e.get(r,n)):0}))}function ee(e){var t;return!(e=null!==(t=e)&&void 0!==t?t:function(e){return e})instanceof Function?function(t){return e}:e}function te(){var e=Promise.resolve(),t=void 0;function r(){var e=t;return t=void 0,e()}return function(n){var o=t;t=n,o||(e=e.then((function(e){if(e)return e()})).then(r,r))}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ne(e){var t=e.constraints,r=e.onFrame,o=(0,n.useRef)(),a=(0,n.useRef)();a.current=r;var i,u,c=(i=(0,n.useState)(te),u=1,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(i,u)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(e,t):void 0}}(i,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],l=x(),s=(0,n.useRef)();s.current=l,(0,q.F_)((function(){c((function(){return l.wrapPromise(navigator.mediaDevices.getUserMedia(t).then((function(e){return o.current.srcObject=e,l.wrap((function(){return function(e){e&&e.getTracks().forEach((function(t){e.removeTrack(t),t.stop()}))}(e)}))})))}))}),[t,l]);var f=(0,n.useCallback)((function(e){function t(t,n){if(o.current==e){try{a.current&&a.current(t,n,e)}catch(e){s.current.onError(e)}r()}}function r(){e.requestVideoFrameCallback(t)}o.current=e,r()}),[]);return n.createElement("video",{ref:f,playsInline:!0,autoPlay:!0,style:{display:"none"}})}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ae=[[-.75,0,0,1],[-.25,0,0,1],[.25,0,0,1],[.75,0,0,1]].map((function(e){return new Float32Array(e)})),ie=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]].map((function(e){return new Float32Array(e)})),ue=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gl=t,this.nsamples=r,this.program=J.EK(t,["\n  attribute highp vec2 aTextureCoord;\n  \n  uniform highp vec4 uVertexPosition;\n    \n  varying highp vec2 vTextureCoord;\n  \n  void main(void) {\n    gl_Position = uVertexPosition;\n    gl_PointSize = 1.0;\n    vTextureCoord = aTextureCoord;\n  }\n","\n  varying highp vec2 vTextureCoord;\n  \n  uniform highp mat3 uCoordMatrix;\n  uniform sampler2D uSampler;\n  uniform highp vec4 uChannelIndex;\n\n  void main(void) {\n    highp vec4 texelColor = texture2D(uSampler, vec2(uCoordMatrix * vec3(vTextureCoord, 1)));\n    \n    highp float channelValue = dot(uChannelIndex, vec4(texelColor.rgb, 1));\n    gl_FragColor = channelValue * vec4(texelColor.rgb, 1);\n  }\n"]),this.buffers=J.qX(t,{aTextureCoord:Array(2*r).fill(0).map((function(e){return Math.random()})),indices:k(r)}),this.textureSampler=J.bb(t,{minMag:t.NEAREST}),this.fb=J.pL(t,[{type:t.FLOAT,format:t.RGBA,internalFormat:t.RGBA32F,min:t.NEAREST,mag:t.NEAREST,wrap:t.CLAMP_TO_EDGE}],4,1)}var t,r;return t=e,(r=[{key:"sample",value:function(e,t){var r=this.gl;for(var n in J.GG(r,this.fb),r.useProgram(this.program.program),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.disable(r.DEPTH_TEST),J.o8(r,this.program,this.buffers),r.blendFunc(r.ONE,r.ONE),r.enable(r.BLEND),k(4))J.N9(this.program,{uVertexPosition:ae[n],uCoordMatrix:t,uChannelIndex:ie[n],uSampler:{texture:e,sampler:this.textureSampler}}),r.drawElements(r.POINTS,this.nsamples,r.UNSIGNED_SHORT,0);var o=new Float32Array(16);return r.readBuffer(r.COLOR_ATTACHMENT0),r.readPixels(0,0,4,1,r.RGBA,r.FLOAT,o),r.blendFunc(r.ONE,r.ZERO),r.disable(r.BLEND),o}}])&&oe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var le=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gl=t,this.program=J.EK(t,["\n  attribute vec4 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  uniform highp mat4 uPositionMatrix;\n\n  varying highp vec2 vTextureCoord;\n\n  void main(void) {\n    gl_Position = uPositionMatrix * aVertexPosition;\n    vTextureCoord = aTextureCoord;\n  }\n","\n  varying highp vec2 vTextureCoord;\n\n  uniform sampler2D uSampler;\n  uniform highp mat4 uColorMatrix;\n\n  void main(void) {\n    highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor = uColorMatrix * vec4(texelColor.rgb, 1);\n  }\n"]),this.buffers=J.qX(t,{aVertexPosition:[-1,-1,0,1,-1,0,1,1,0,-1,1,0],aTextureCoord:[0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3]})}var t,r;return t=e,r=[{key:"display",value:function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=this.gl,c=u.canvas.getBoundingClientRect();i?(u.canvas.width=i.width,u.canvas.height=i.height):(u.canvas.width=c.width*window.devicePixelRatio,u.canvas.height=c.height*window.devicePixelRatio);var l=Math.max(r,n),s=r/l,f=n/l,p=a.Ue();p[0]=.5*s,p[5]=-.5*f;var h=Math.max(c.width,c.height),v=c.width/h,m=c.height/h,d=Math.max(u.canvas.width,u.canvas.height),y=u.canvas.width/d,g=u.canvas.height/d,b=Math.max(y/v,g/m),w=a.Ue();w[0]=2/y*b,w[5]=-2/g*b,o&&a.Jp(p,o,p),a.Jp(p,w,p),u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.useProgram(this.program.program),u.clearColor(0,0,0,1),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),u.enable(u.DEPTH_TEST),u.depthFunc(u.LEQUAL),J.o8(u,this.program,this.buffers),J.N9(this.program,{uPositionMatrix:p,uSampler:{texture:t},uColorMatrix:e}),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0)}}],r&&ce(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function se(e){var t=x(),r=(0,n.useRef)();r.current=e;var o=e.decor,i=e.post,u=e.projection,c=e.videoConstraints,l=(0,n.useRef)(),s=(0,n.useRef)(),f=(0,n.useRef)(),p=(0,n.useCallback)(t.wrap((function(e){l.current=e;var n=e.getContext("webgl2");if(!n)throw Error("Could not get webgl2 context");J.pV(n),n.getExtension("EXT_color_buffer_float")||t.onError(Error("Could not get WebGL extenstion EXT_color_buffer_float"));var o,i,u,c=J.cU(n,{mag:n.LINEAR,min:n.LINEAR,src:[0,0,255,255]}),p={width:1,height:1},h=!1,v=new ue(n,1e3),m=new le(n);o=function(t){var o=r.current,i=o.decor,u=o.post,l=o.projection,s=o.captureSignal;f.current&&(n.bindTexture(n.TEXTURE_2D,c),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,f.current.camera),p=f.current.frame,h=!0,f.current=null);var d=a.Ue(),y=W.Ue(),g=p.width,b=p.height;if(l){var w=l(p.width/p.height);d=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a.al(r,0,0,0,0,r*n,0,0,0,0,1,0,e,t,0,1)}(w.toScreen.x,w.toScreen.y,w.toScreen.scale);var E=w.screenBoundsInImage;W.Iu(y,y,X.al(.5+E.left/w.imageWidth,.5+E.top/w.imageHeight));var x=(E.right-E.left)/w.imageWidth,O=(E.bottom-E.top)/w.imageHeight;W.bA(y,y,X.al(x,O)),g=p.width*x,b=p.height*O}var S,C,j=a.Ue();if(h){if(i){var P=v.sample(c,y),T=function(e,t){return P[4*e+t]};j=function(e,t,r){var n,o=null!==(n=r.corr)&&void 0!==n&&n,i=Q(e,Math.sqrt),u=Q(i,(function(e){return 1/e})),c=e;o&&(c=u.mmul(e).mmul(u));var l=new K.Z(c),s=Q(l.diagonalMatrix,(function(e){return 1/Math.sqrt(e)})),f=ee(r.sigma)(i).mmul(l.eigenvectorMatrix).mmul(s).mmul(l.eigenvectorMatrix.transpose());o&&(f=f.mmul(u));var p=function(e){return t=function(t,r){return t<e.rows&&r<e.columns?e.get(t,r):t==r?1:0},a.al(t(0,0),t(1,0),t(2,0),t(3,0),t(0,1),t(1,1),t(2,1),t(3,1),t(0,2),t(1,2),t(2,2),t(3,2),t(0,3),t(1,3),t(2,3),t(3,3));var t}(f),h=t.map((function(e){return-1*e})),v=ee(r.mean)(t),m=a.Ue();a.vc(m,h);var d=a.Ue();return a.vc(d,v),a.Jp(p,p,m),a.Jp(p,d,p),p}((C=(S=T)(3,3),Y(3,3,(function(e,t){return(S(e,t)-S(e,3)*S(3,t)/C)/(C-1)}))),$.al(T(0,3)/T(3,3),T(1,3)/T(3,3),T(2,3)/T(3,3)),i)}u&&a.Jp(j,u,j)}var A,I=s();I&&(A={width:g,height:b}),m.display(j,c,p.width,p.height,d,A),I&&e.toBlob((function(e){(0,Z.saveAs)(e,I.fileName)}),I.type)},i=void 0,u=function(e){if(e!=i){i=e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o.apply(void 0,[e].concat(r))}},s.current=u})),[]);function h(){s.current&&window.requestAnimationFrame(t.wrap(s.current))}return(0,q.F_)(h,[o,i,u]),n.createElement(n.Fragment,null,n.createElement("canvas",{ref:p,className:"maximal",style:{objectFit:"contain"}}),n.createElement(ne,{constraints:{audio:!1,video:c},onFrame:function(e,t,r){f.current={frame:t,camera:r},h()}}))}function fe(e){var t=e.getBoundingClientRect(),r=document.body,n=document.documentElement,o=window.pageYOffset||n.scrollTop||r.scrollTop,a=window.pageXOffset||n.scrollLeft||r.scrollLeft,i=n.clientTop||r.clientTop||0,u=n.clientLeft||r.clientLeft||0,c=t.top+o-i,l=t.left+a-u;return{x:Math.round(l),y:Math.round(c),width:t.width,height:t.height}}function pe(e,t){var r=fe(e),n=Math.max(r.height,r.width);return{x:(t.center.x-(r.x+r.width/2))/n,y:(t.center.y-(r.y+r.height/2))/n}}var he=function(e){return e>1?{width:1,height:1/e}:{width:e,height:1}};function ve(e,t,r){if(e>=t)return 0;var n,o,a,i=t/2-e/2;return n=-i,o=r,a=i,Math.max(n,Math.min(o,a))}function me(e,t){var r=t.x,n=t.y;return{x:r*e.scale+e.x,y:n*e.scale+e.y}}function de(e){var t=e.x,r=e.y,n=e.scale;return{x:-t/n,y:-r/n,scale:1/n}}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ge(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function be(e){if(e instanceof Function){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,r)}return e}function we(e,t){var r=x(),o=(0,n.useState)((function(){return function(e,t,r){try{var n=window.localStorage.getItem(e);if(n)return JSON.parse(n)}catch(e){r.onError(e)}return be(t)}(e,t,r)})),a=ye(o,2),i=a[0],u=a[1],c=(0,n.useCallback)((function(t){u((function(n){var o=be(t,n);return function(e,t,r){try{var n=JSON.stringify(t);window.localStorage.setItem(e,n)}catch(e){r.onError(e)}}(e,o,r),o}))}),[r]);return[i,c]}var Ee=r(157),xe={value:"image/jpeg",label:"JPEG",extension:".jpg"},Oe={value:"image/png",label:"PNG",extension:".png"};function Se(e){var t=e.value,r=e.onChange;return n.createElement(Ee.ZP,{isSearchable:!1,value:t,options:[xe,Oe],onChange:r})}function Ce(){return Ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ce.apply(this,arguments)}function je(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Te,Ae=a.al(-1,0,0,0,0,-1,0,0,0,0,-1,0,1,1,1,1),Ie=[{decor:{}},{},{post:Ae},{decor:{},post:Ae}],Me=function(e){return(e+1)%Ie.length},ke=function(e){return(e+Ie.length-1)%Ie.length};function Re(e){var t=e.filePrefix,r=void 0===t?"Contrast Visor capture":t,o=x(),a=je((0,n.useState)(!1),2),i=a[0],c=a[1],l=je((0,n.useState)(0),2),s=l[0],f=l[1],p=je((0,n.useState)(),2),h=p[0],v=p[1],m=je(we("contrast-visor.settings.videoConstraints",H),2),d=m[0],y=m[1],g=je(we("contrast-visor.settings.imageFormat",Oe),2),b=g[0],w=g[1],E=function(){var e=ye((0,n.useState)(),2),t=e[0],r=e[1],o=(0,n.useCallback)((function(e){r({set:!0,signal:e})}));return[(0,n.useCallback)((function(){if(null!=t&&t.set){t.set=!1;var e=t.signal;return t.signal=null,e}}),[t]),o]}(),C=je(E,2),T=C[0],A=C[1],I="wrapper maximal "+(i?"settingsOpen":"settingsClosed"),M=Ie[s%Ie.length],k=je((0,n.useState)({}),1)[0];k.tap=(0,n.useCallback)((function(){A({type:b.value,fileName:r+" "+(new Date).toJSON().replace("T"," ").replaceAll(":",".")+b.extension})}),[b,r]);var R=(0,n.useCallback)((function(e){var t,r=new(u().Manager)(e,{recognizers:[[u().Tap,{taps:2}],[u().Swipe],[u().Pinch]],touchAction:"none"});function n(){return window.getComputedStyle(e).getPropertyValue("--cv-horizontal-layout")}function o(e,t,o,a){r.on(e,(function(){return n()?o():a()})),r.on(t,(function(){return n()?a():o()}))}r.on("tap",(function(){return k.tap()})),o("swipeleft","swipedown",(function(){return c(!0)}),(function(){return f(Me)})),o("swiperight","swipeup",(function(){return c(!1)}),(function(){return f(ke)})),function(e,t,r){var n={x:0,y:0,scale:1},o=void 0,a=void 0;function i(t,r){var o,a,i=fe(e),u=i.width/i.height,c=he(u),l=c.width,s=c.height,f=he(r),p=f.width,h=f.height,v=Math.min(l/p,s/h),m={x:0,y:0,scale:v},d=t.scale*v,y=ve(l,p*d,t.x),g=ve(s,h*d,t.y),b=(a=m,{x:(o=n={x:y,y:g,scale:t.scale}).scale*a.x+o.x,y:o.scale*a.y+o.y,scale:o.scale*a.scale}),w=de(b),E=me(w,{x:-l/2,y:-s/2}),x=me(w,{x:l/2,y:s/2});return{toScreen:b,screenBoundsInImage:{left:Math.max(-p/2,E.x),right:Math.min(p/2,x.x),top:Math.max(-h/2,E.y),bottom:Math.min(h/2,x.y)},imageWidth:p,imageHeight:h}}t.on("pinchstart",(function(t){var r=pe(e,t);a=me(de(n),r),o=n})),t.on("pinch",(function(t){var n=pe(e,t),u=Math.max(t.scale*o.scale,1),c={x:n.x-a.x*u,y:n.y-a.y*u,scale:u};r((function(e){return i(c,e)}))})),r((function(e){return i(n,e)}))}(e,r,(t=v,function(e){return t((function(){return e}))}))}),[]);return n.createElement("div",{className:I},n.createElement("div",{ref:R,className:"screen maximal",style:{position:"relative"}},n.createElement(j,{chainErrorHandler:o},n.createElement(S,null,n.createElement(se,Ce({videoConstraints:d,projection:h},M,{captureSignal:T}))))),n.createElement("div",{className:"settings"},n.createElement(G,{constraints:d,onChange:y}),n.createElement("label",null,"Image format:",n.createElement(Se,{value:b,onChange:w})),n.createElement(O.Consumer,null,(function(e){return n.createElement(P,{errors:e})}))))}function _e(e){var t=x();return n.createElement(S,null,n.createElement(C,{chainErrorHandler:t},n.createElement(Re,e)))}r(66),r(140),document.getElementById("errors"),document.getElementById("downloader"),o.render(n.createElement(_e,null),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("sw.js",{scope:"."}).then((function(e){console.log("SW registered: ",e)})).catch((function(e){console.log("SW registration failed: ",e)}))}));var Ne=document.querySelector(".add-button");Ne.style.display="none",window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),Te=e,Ne.style.display="block",Ne.addEventListener("click",(function(){Ne.style.display="none",Te.prompt(),Te.userChoice.then((function(e){"accepted"===e.outcome?console.log("User accepted the web prompt"):console.log("User dismissed the web prompt"),Te=null}))}))}))},66:(e,t,r)=>{e.exports=r.p+"imgs\\eye162.png"},140:(e,t,r)=>{e.exports=r.p+"manifest.webmanifest"}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(s=0;s<e.length;s++){for(var[r,o,a]=e[s],u=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](r[c])))?r.splice(c--,1):(u=!1,a<i&&(i=a));if(u){e.splice(s--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,o,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,u,c]=r,l=0;if(i.some((t=>0!==e[t]))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(c)var s=c(n)}for(t&&t(r);l<i.length;l++)a=i[l],n.o(e,a)&&e[a]&&e[a][0](),e[i[l]]=0;return n.O(s)},r=self.webpackChunkcontrastvisor=self.webpackChunkcontrastvisor||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=n.O(void 0,[216],(()=>n(262)));o=n.O(o)})();