(()=>{"use strict";var e,t={186:(e,t,r)=>{var n=r(7294),o=r(3935),a=r(5975),i=r(840),u=r.n(i),l=r(3157),c=r(8100),s=r(888);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function d(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}r(9957);var E={onError:console.error},O=function(){function e(t){g(this,e),this.errorHandler=t}return w(e,[{key:"onError",value:function(){var e;(e=this.errorHandler).onError.apply(e,arguments)}},{key:"wrapPromise",value:function(e){var t=this;return e.catch((function(e){if(e instanceof Error)t.errorHandler.onError(e);else try{throw new Error("Promise rejected with reason "+(null==e?void 0:e.toString()))}catch(e){t.errorHandler.onError(e)}return Promise.reject(e)}))}},{key:"wrap",value:function(e){var t=this;return function(){try{return e.apply(void 0,arguments)}catch(e){throw t.errorHandler.onError(e),e}}}}]),e}(),x=n.createContext(new O(E)),S=function(){return(0,n.useContext)(x)},C=n.createContext([]),j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,r,o=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=y(t);if(r){var o=y(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return d(this,e)});function a(e){var t;return g(this,a),(t=o.call(this,e)).state={error:null,errorInfo:null},t}return w(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?n.createElement(I,{error:this.state.error,details:this.state.errorInfo.componentStack}):this.props.children}}]),a}(n.Component);function P(e){var t=e.children,r=e.chainErrorHandler,o=p((0,n.useState)([]),2),a=o[0],i=o[1],u=(0,n.useMemo)((function(){return new O({onError:function(e){i((function(t){return[].concat(function(e){if(Array.isArray(e))return v(e)}(r=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||h(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e]);var r})),r&&r.onError(e)}})}),[r]);return n.createElement(C.Provider,{value:a},n.createElement(x.Provider,{value:u},t))}function T(e){var t=e.children,r=e.chainErrorHandler,o=p((0,n.useState)(),2),a=o[0],i=o[1],u=(0,n.useCallback)((function(e){if(null!=e&&e.length)return a?n.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,background:"white"}},n.createElement(A,{errors:e}),n.createElement("button",{onClick:function(){return i(!1)}},"X")):n.createElement("button",{style:{position:"absolute",bottom:0,right:0},onClick:function(){return i(!0)}},"Errors!")}),[a]);return n.createElement(P,{chainErrorHandler:r},t,n.createElement(C.Consumer,null,u))}function A(e){var t=e.errors;return n.createElement("div",{className:"errorLog"},t.map((function(e){return n.createElement(I,{error:e,key:e})})))}function I(e){var t=e.error,r=e.details;return null!=t&&t.stack||r?n.createElement("details",{className:"errorLogEntry"},n.createElement("summary",null,null==t?void 0:t.toString()),(null==t?void 0:t.stack)&&n.createElement("div",{className:"stackTrace"},null==t?void 0:t.stack),r&&n.createElement("div",{className:"details"},r)):n.createElement("div",{className:"errorLogEntry"},null==t?void 0:t.toString())}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var M=function(e){return Array(e).fill().map((function(e,t){return t}))},F=function(e){return e},R=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){for(var r=t.length-1;r>=0;r--)e=t[r](e);return e}},D=function(e){return e instanceof Function?e:(t=e,function(){return t});var t};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var G={map:F,pure:F,ap:F},V={map:function(e){return F}},W=function(e){return function(t){return function(r){return function(n){return r.map((function(t){return B(B({},n),{},H({},e,t))}))(t(r)(null==n?void 0:n[e]))}}}},X=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Proxy(R.apply(void 0,t),q(t))},q=function(e){var t={};return{get:function(r,n,o){if(t[n])return t[n];var a,i=X.apply(void 0,(a=e,function(e){if(Array.isArray(e))return L(e)}(a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([W(n)]));return t[n]=i,i}}};function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z(e,t){var r=S(),o=(0,n.useState)((function(){return function(e,t,r){try{var n=window.localStorage.getItem(e);if(n)return JSON.parse(n)}catch(e){r.onError(e)}return D(t)()}(e,t,r)})),a=J(o,2),i=a[0],u=a[1],l=(0,n.useCallback)((function(t){u((function(n){var o=D(t)(n);return function(e,t,r){try{var n=JSON.stringify(t);window.localStorage.setItem(e,n)}catch(e){r.onError(e)}}(e,o,r),o}))}),[r]);return[i,l]}function z(){return(0,n.useMemo)(X)}function K(e,t,r){var o=(0,n.useCallback)((function(t){return r((n=D(t),function(e){return e((function(e){return n}))(G)})(e));var n}),[e,r]),a=function(e){return e((function(e){return F}))(V)}(e)(t);return[a,o]}var Y=["position"],Q=["loadOptions"],ee=["value","options","defaultLabel","onChange"];function te(){return te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},te.apply(this,arguments)}function re(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||oe(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){if(e){if("string"==typeof e)return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ce=4096;function se(e){var t=e.settings,r=e.onChange,o=(null==t?void 0:t.deviceId)||"",a=z(),i=ne(K(a.deviceId,t,r),2),u=i[0],l=i[1],c=ne(K(a.byDeviceId[o].width,t,r),2),s=c[0],f=c[1],p=ne(K(a.byDeviceId[o].height,t,r),2),h=p[0],v=p[1];return n.createElement(n.Fragment,null,n.createElement("section",{className:"fieldSetLike"},n.createElement("h6",null,"Camera:"),n.createElement(fe,{value:u,onChange:l}),n.createElement("section",{className:"labelLike"},n.createElement("h6",null,"Width:"),n.createElement(de,{value:s,onChange:f})),n.createElement("section",{className:"labelLike"},n.createElement("legend",null,"Height"),n.createElement(de,{value:h,onChange:v}))))}function fe(e){var t=e.value,r=e.onChange,o={menu:function(e){return e.position,re(e,Y)}},a=(0,n.useCallback)((function(e){return navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"videoinput"==e.kind})).map((function(e){return{value:e.deviceId,label:e.label||e.deviceId}}))}))}),[]);return n.createElement(pe,{className:"reactSelect","aria-label":"Video input device",isSearchable:!1,isClearable:!0,loadOptions:a,value:t,defaultLabel:(null==t?void 0:t.toString())||"Any",onChange:r,styles:o})}function pe(e){var t=e.loadOptions,r=re(e,Q),o=S(),a=ne((0,n.useState)([]),2),i=a[0],u=a[1],l=ne((0,n.useState)(0),2),c=l[0],s=l[1],f=(0,n.useCallback)((function(){s((function(e){return e+1})),o.wrapPromise(o.wrap(t)().then(u).finally((function(){return s((function(e){return e-1}))})))}),[t,o]);return(0,n.useEffect)(f,[t]),n.createElement(he,te({options:i,onMenuOpen:f,isLoading:c},r))}function he(e){var t=e.value,r=e.options,o=e.defaultLabel,a=e.onChange,i=re(e,ee),u=(0,n.useMemo)((function(){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F;return e.reduce((function(e,n){return N(N({},e),{},_({},t(n),r(n)))}),{})}(r,(function(e){return e.value}))}),[r]);return n.createElement(l.ZP,te({options:r,value:u[t]||{value:t,label:o}},i,{onChange:function(e){return a(null==e?void 0:e.value)}}))}var ve=[4096,3840,3072,2880,2560,2304,2048,2160,1920,1600,1440,1280,1200,1024,1080,960,720,800,640,600,480];function me(e){return{exact:Boolean(null==e?void 0:e.exact),resolution:(null==e?void 0:e.exact)||(null==e?void 0:e.ideal)}}function de(e){var t=e.value,r=e.onChange,o=me(t),a=(0,n.useCallback)((function(e){return r((function(t){return function(e){if(null!=e&&e.resolution)return null!=e&&e.exact?{exact:e.resolution}:{ideal:e.resolution}}(D(e)(me(t)))}))}),[r]),i=ne((0,n.useState)(ve),2),u=i[0],l=i[1],f=z(),p=ne(K(f.exact,o,a),2),h=p[0],v=p[1],m=ne(K(f.resolution,o,a),2),d=m[0],y=m[1],g=(0,n.useCallback)((function(e){return parseInt(e)>0&&parseInt(e)<=ce}),[]),b=(0,n.useCallback)((function(e){var t=parseInt(e);l((function(e){return e.includes(t)?e:[].concat((r=e,function(e){if(Array.isArray(e))return ae(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||oe(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[t]).sort((function(e,t){return t-e}));var r})),y(t)}),[]);return n.createElement("div",{className:"resolutionSelector"},n.createElement(s.Z,{"aria-label":"Use exact resolution",checked:h,disabled:!d,icons:{checked:n.createElement("span",{className:"toggleSymbol"},"="),unchecked:n.createElement("span",{className:"toggleSymbol"},"â‰ˆ")},onChange:function(e){return v(e.target.checked)}}),n.createElement(c.Z,{className:"resolution reactSelect","aria-label":"Resolution",isClearable:!0,value:{value:d,label:d||"Any"},onChange:function(e){return y(null==e?void 0:e.value)},options:u.map((function(e){return{value:e,label:e}})),isValidNewOption:g,onCreateOption:b}))}var ye=r(3141),ge=r(5600),be=r(1437),we=r(7160),Ee=r(7069),Oe=r(3162),xe=r(3754),Se=r(7948);function Ce(e,t,r){return new xe.Z(M(e).map((function(e){return M(t).map((function(t){return r(e,t)}))})))}function je(e,t){return Ce(e.rows,e.columns,(function(r,n){return r==n?t(e.get(r,n)):0}))}function Pe(e){var t;return!(e=null!==(t=e)&&void 0!==t?t:function(e){return e})instanceof Function?function(t){return e}:e}function Te(){var e=Promise.resolve(),t=void 0;function r(){var e=t;return t=void 0,e()}return function(n){var o=t;t=n,o||(e=e.then((function(e){if(e)return e()})).then(r,r))}}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ie(e){var t=e.constraints,r=e.onFrame,o=(0,n.useRef)(),a=(0,n.useRef)();a.current=r;var i,u,l=(i=(0,n.useState)(Te),u=1,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(i,u)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ae(e,t):void 0}}(i,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c=S(),s=(0,n.useRef)();s.current=c,(0,Ee.F_)((function(){l((function(){return c.wrapPromise(navigator.mediaDevices.getUserMedia(t).then((function(e){return o.current.srcObject=e,c.wrap((function(){return function(e){e&&e.getTracks().forEach((function(t){e.removeTrack(t),t.stop()}))}(e)}))})))}))}),[t,c]);var f=(0,n.useCallback)((function(e){var t;function r(r,n){if(o.current==e){try{a.current&&a.current(r,n,e)}catch(e){s.current.onError(e)}t()}}null!=e&&(o.current=e,(t=e.requestVideoFrameCallback?function(){return e.requestVideoFrameCallback(r)}:function(){return window.requestAnimationFrame((function(t){return r(t,{width:e.videoWidth,height:e.videoHeight})}))})())}),[]);return n.createElement("video",{ref:f,playsInline:!0,autoPlay:!0,style:{display:"none"}})}var ke=r(2425);function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Me="\n  attribute highp vec2 aTextureCoord;\n  \n  uniform highp vec4 uVertexPosition;\n    \n  varying highp vec2 vTextureCoord;\n  \n  void main(void) {\n    gl_Position = uVertexPosition;\n    gl_PointSize = 1.0;\n    vTextureCoord = aTextureCoord;\n  }\n",Fe="\n  varying highp vec2 vTextureCoord;\n  \n  uniform highp mat3 uCoordMatrix;\n  uniform sampler2D uSampler;\n  uniform highp vec4 uChannelIndex;\n\n  void main(void) {\n    highp vec4 texelColor = texture2D(uSampler, vec2(uCoordMatrix * vec3(vTextureCoord, 1)));\n    \n    highp float channelValue = dot(uChannelIndex, vec4(texelColor.rgb, 1));\n    gl_FragColor = channelValue * vec4(texelColor.rgb, 1);\n  }\n",Re=[[-.75,0,0,1],[-.25,0,0,1],[.25,0,0,1],[.75,0,0,1]].map((function(e){return new Float32Array(e)})),De=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]].map((function(e){return new Float32Array(e)}));function Le(e,t){return 16==t?{type:e.HALF_FLOAT,internalFormat:e.RGBA16F,arrayType:function(e){return new Uint16Array(e)},view:function(e){return new ke.n(e.buffer)}}:{type:e.FLOAT,internalFormat:e.RGBA32F,arrayType:function(e){return new Float32Array(e)},view:function(e){return e}}}var Ue=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32;Ne(this,e),this.gl=t,this.nsamples=r,this.floatType=Le(t,n),this.program=ye.EK(t,[Me,Fe]),this.buffers=ye.qX(t,{aTextureCoord:Array(2*r).fill(0).map((function(e){return Math.random()})),indices:M(r)}),this.textureSampler=ye.bb(t,{minMag:t.NEAREST}),this.fb=ye.pL(t,[{type:this.floatType.type,format:t.RGBA,internalFormat:this.floatType.internalFormat,min:t.NEAREST,mag:t.NEAREST,wrap:t.CLAMP_TO_EDGE}],4,1)}var t,r;return t=e,(r=[{key:"sample",value:function(e,t){var r=this.gl;for(var n in ye.GG(r,this.fb),r.useProgram(this.program.program),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.disable(r.DEPTH_TEST),ye.o8(r,this.program,this.buffers),r.blendFunc(r.ONE,r.ONE),r.enable(r.BLEND),M(4))ye.N9(this.program,{uVertexPosition:Re[n],uCoordMatrix:t,uChannelIndex:De[n],uSampler:{texture:e,sampler:this.textureSampler}}),r.drawElements(r.POINTS,this.nsamples,r.UNSIGNED_SHORT,0);var o=this.floatType.arrayType(16);return r.readBuffer(r.COLOR_ATTACHMENT0),r.readPixels(0,0,4,1,r.RGBA,this.floatType.type,o),r.blendFunc(r.ONE,r.ZERO),r.disable(r.BLEND),this.floatType.view(o)}}])&&_e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var He=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gl=t,this.program=ye.EK(t,["\n  attribute vec4 aVertexPosition;\n  attribute vec2 aTextureCoord;\n\n  uniform highp mat4 uPositionMatrix;\n\n  varying highp vec2 vTextureCoord;\n\n  void main(void) {\n    gl_Position = uPositionMatrix * aVertexPosition;\n    vTextureCoord = aTextureCoord;\n  }\n","\n  varying highp vec2 vTextureCoord;\n\n  uniform sampler2D uSampler;\n  uniform highp mat4 uColorMatrix;\n\n  void main(void) {\n    highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor = uColorMatrix * vec4(texelColor.rgb, 1);\n  }\n"]),this.buffers=ye.qX(t,{aVertexPosition:[-1,-1,0,1,-1,0,1,1,0,-1,1,0],aTextureCoord:[0,1,1,1,1,0,0,0],indices:[0,1,2,0,2,3]})}var t,r;return t=e,r=[{key:"display",value:function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=this.gl,l=u.canvas.getBoundingClientRect();i?(u.canvas.width=i.width,u.canvas.height=i.height):(u.canvas.width=l.width*window.devicePixelRatio,u.canvas.height=l.height*window.devicePixelRatio);var c=Math.max(r,n),s=r/c,f=n/c,p=a.Ue();p[0]=.5*s,p[5]=-.5*f;var h=Math.max(l.width,l.height),v=l.width/h,m=l.height/h,d=Math.max(u.canvas.width,u.canvas.height),y=u.canvas.width/d,g=u.canvas.height/d,b=Math.max(y/v,g/m),w=a.Ue();w[0]=2/y*b,w[5]=-2/g*b,o&&a.Jp(p,o,p),a.Jp(p,w,p),u.bindFramebuffer(u.FRAMEBUFFER,null),u.viewport(0,0,u.canvas.width,u.canvas.height),u.useProgram(this.program.program),u.clearColor(0,0,0,1),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),u.enable(u.DEPTH_TEST),u.depthFunc(u.LEQUAL),ye.o8(u,this.program,this.buffers),ye.N9(this.program,{uPositionMatrix:p,uSampler:{texture:t},uColorMatrix:e}),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0)}}],r&&Be(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ge(e){var t=S(),r=(0,n.useRef)();r.current=e;var o=e.decor,i=e.post,u=e.projection,l=e.videoConstraints,c=(0,n.useRef)(),s=(0,n.useRef)(),f=(0,n.useRef)(),p=(0,n.useCallback)(t.wrap((function(e){if(null!=e){c.current=e;var n=e.getContext("webgl2");if(!n)throw Error("Could not get webgl2 context");ye.pV(n);var o=32;n.getExtension("EXT_color_buffer_float")||(n.getExtension("EXT_color_buffer_half_float")?o=16:t.onError(Error("Could not get WebGL extenstion EXT_color_buffer_float or EXT_color_buffer_half_float")));var i,u,l,p=ye.cU(n,{mag:n.LINEAR,min:n.LINEAR,src:[0,0,255,255]}),h={width:1,height:1},v=!1,m=new Ue(n,1e3,o),d=new He(n),y=a.Ue();i=function(t){var o=r.current,i=o.decor,u=o.post,l=o.projection,c=o.captureSignal;f.current&&(n.bindTexture(n.TEXTURE_2D,p),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,f.current.camera),h=f.current.frame,v=!0,f.current=null);var s=a.Ue(),g=ge.Ue(),b=h.width,w=h.height;if(l){var E=l(h.width/h.height);s=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a.al(r,0,0,0,0,r*n,0,0,0,0,1,0,e,t,0,1)}(E.toScreen.x,E.toScreen.y,E.toScreen.scale);var O=E.screenBoundsInImage;ge.Iu(g,g,be.al(.5+O.left/E.imageWidth,.5+O.top/E.imageHeight));var x=(O.right-O.left)/E.imageWidth,S=(O.bottom-O.top)/E.imageHeight;ge.bA(g,g,be.al(x,S)),b=h.width*x,w=h.height*S}var C,j,P=a.Ue(),T=a.Ue();if(v){if(i){var A=m.sample(p,g),I=function(e,t){return A[4*e+t]};T=function(e,t,r){var n,o=null!==(n=r.corr)&&void 0!==n&&n,i=je(e,Math.sqrt),u=je(i,(function(e){return 1/e})),l=e;o&&(l=u.mmul(e).mmul(u));var c=new Se.Z(l),s=je(c.diagonalMatrix,(function(e){return 1/Math.sqrt(e)})),f=Pe(r.sigma)(i).mmul(c.eigenvectorMatrix).mmul(s).mmul(c.eigenvectorMatrix.transpose());o&&(f=f.mmul(u));var p=function(e){return t=function(t,r){return t<e.rows&&r<e.columns?e.get(t,r):t==r?1:0},a.al(t(0,0),t(1,0),t(2,0),t(3,0),t(0,1),t(1,1),t(2,1),t(3,1),t(0,2),t(1,2),t(2,2),t(3,2),t(0,3),t(1,3),t(2,3),t(3,3));var t}(f),h=t.map((function(e){return-1*e})),v=Pe(r.mean)(t),m=a.Ue();a.vc(m,h);var d=a.Ue();return a.vc(d,v),a.Jp(p,p,m),a.Jp(p,d,p),p}((j=(C=I)(3,3),Ce(3,3,(function(e,t){return(C(e,t)-C(e,3)*C(3,t)/j)/(j-1)}))),we.al(I(0,3)/I(3,3),I(1,3)/I(3,3),I(2,3)/I(3,3)),i),T.some(isNaN)?T=y:y=T}u?a.Jp(P,u,T):P=T}var k,N=c();N&&(k={width:b,height:w}),d.display(P,p,h.width,h.height,s,k),N&&e.toBlob((function(e){(0,Oe.saveAs)(e,N.fileName)}),N.type)},u=void 0,l=function(e){if(e!=u){u=e;for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i.apply(void 0,[e].concat(r))}},s.current=l}})),[]);function h(){s.current&&window.requestAnimationFrame(t.wrap(s.current))}return(0,Ee.F_)(h,[o,i,u]),n.createElement(n.Fragment,null,n.createElement("canvas",{ref:p,className:"maximal",style:{objectFit:"contain"}}),n.createElement(Ie,{constraints:{audio:!1,video:l},onFrame:function(e,t,r){f.current={frame:t,camera:r},h()}}))}function Ve(e){var t=e.getBoundingClientRect(),r=document.body,n=document.documentElement,o=window.pageYOffset||n.scrollTop||r.scrollTop,a=window.pageXOffset||n.scrollLeft||r.scrollLeft,i=n.clientTop||r.clientTop||0,u=n.clientLeft||r.clientLeft||0,l=t.top+o-i,c=t.left+a-u;return{x:Math.round(c),y:Math.round(l),width:t.width,height:t.height}}function We(e,t){var r=Ve(e),n=Math.max(r.height,r.width);return{x:(t.center.x-(r.x+r.width/2))/n,y:(t.center.y-(r.y+r.height/2))/n}}var Xe=function(e){return e>1?{width:1,height:1/e}:{width:e,height:1}};function qe(e,t,r){if(e>=t)return 0;var n,o,a,i=t/2-e/2;return n=-i,o=r,a=i,Math.max(n,Math.min(o,a))}function Je(e,t){var r=t.x,n=t.y;return{x:r*e.scale+e.x,y:n*e.scale+e.y}}function $e(e){var t=e.x,r=e.y,n=e.scale;return{x:-t/n,y:-r/n,scale:1/n}}var Ze={value:"image/jpeg",label:"JPEG",extension:".jpg"},ze={value:"image/png",label:"PNG",extension:".png"};function Ke(e){var t=e.value,r=e.onChange;return n.createElement(l.ZP,{className:"reactSelect",isSearchable:!1,value:t,options:[Ze,ze],onChange:r})}function Ye(){return Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ye.apply(this,arguments)}function Qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tt,rt=a.al(-1,0,0,0,0,-1,0,0,0,0,-1,0,1,1,1,1),nt=[{decor:{}},{},{post:rt},{decor:{},post:rt}],ot=function(e){return(e+1)%nt.length},at=function(e){return(e+nt.length-1)%nt.length};function it(e){var t=e.filePrefix,r=void 0===t?"Contrast Visor capture":t,o=S(),a=Qe((0,n.useState)(!1),2),i=a[0],l=a[1],c=Qe((0,n.useState)(0),2),s=c[0],f=c[1],p=Qe((0,n.useState)(),2),h=p[0],v=p[1],m=Qe(Z("contrast-visor.settings.camera",{}),2),d=m[0],y=m[1],g=Qe(Z("contrast-visor.settings.imageFormat",ze),2),b=g[0],w=g[1],E=function(){var e=J((0,n.useState)(),2),t=e[0],r=e[1],o=(0,n.useCallback)((function(e){r({set:!0,signal:e})}));return[(0,n.useCallback)((function(){if(null!=t&&t.set){t.set=!1;var e=t.signal;return t.signal=null,e}}),[t]),o]}(),O=Qe(E,2),x=O[0],P=O[1],I=function(e){var t,r={width:{max:ce},height:{max:ce}};null!=e&&e.deviceId&&(r.deviceId={exact:e.deviceId});var n=null==e||null===(t=e.byDeviceId)||void 0===t?void 0:t[(null==e?void 0:e.deviceId)||""];return null!=n&&n.width&&(r.width=ue(ue({},n.width),r.width)),null!=n&&n.height&&(r.height=ue(ue({},n.height),r.height)),r}(d),k="wrapper maximal "+(i?"settingsOpen":"settingsClosed"),N=nt[s%nt.length],_=Qe((0,n.useState)({}),1)[0];_.tap=(0,n.useCallback)((function(){P({type:b.value,fileName:r+" "+(new Date).toJSON().replace("T"," ").replaceAll(":",".")+b.extension})}),[b,r]);var M=(0,n.useCallback)((function(e){if(null!=e){var t,r=new(u().Manager)(e,{recognizers:[[u().Tap,{taps:2}],[u().Swipe],[u().Pinch]],touchAction:"none"});r.on("tap",(function(){return _.tap()})),o("swipeleft","swipedown",(function(){return l(!0)}),(function(){return f(ot)})),o("swiperight","swipeup",(function(){return l(!1)}),(function(){return f(at)})),function(e,t,r){var n={x:0,y:0,scale:1},o=void 0,a=void 0;function i(t,r){var o,a,i=Ve(e),u=i.width/i.height,l=Xe(u),c=l.width,s=l.height,f=Xe(r),p=f.width,h=f.height,v=Math.min(c/p,s/h),m={x:0,y:0,scale:v},d=t.scale*v,y=qe(c,p*d,t.x),g=qe(s,h*d,t.y),b=(a=m,{x:(o=n={x:y,y:g,scale:t.scale}).scale*a.x+o.x,y:o.scale*a.y+o.y,scale:o.scale*a.scale}),w=$e(b),E=Je(w,{x:-c/2,y:-s/2}),O=Je(w,{x:c/2,y:s/2});return{toScreen:b,screenBoundsInImage:{left:Math.max(-p/2,E.x),right:Math.min(p/2,O.x),top:Math.max(-h/2,E.y),bottom:Math.min(h/2,O.y)},imageWidth:p,imageHeight:h}}t.on("pinchstart",(function(t){var r=We(e,t);a=Je($e(n),r),o=n})),t.on("pinch",(function(t){var n=We(e,t),u=Math.max(t.scale*o.scale,1),l={x:n.x-a.x*u,y:n.y-a.y*u,scale:u};r((function(e){return i(l,e)}))})),r((function(e){return i(n,e)}))}(e,r,(t=v,function(e){return t((function(){return e}))}))}function n(){return window.getComputedStyle(e).getPropertyValue("--cv-horizontal-layout")}function o(e,t,o,a){r.on(e,(function(){return n()?o():a()})),r.on(t,(function(){return n()?a():o()}))}}),[]);return n.createElement("div",{className:k},n.createElement("div",{ref:M,className:"screen maximal",style:{position:"relative"}},n.createElement(T,{chainErrorHandler:o},n.createElement(j,null,n.createElement(Ge,Ye({videoConstraints:I,projection:h},N,{captureSignal:x}))))),n.createElement("div",{className:"settings"},n.createElement("h1",null,"Contrast Visor ",n.createElement("span",{className:"versionNumber"},"0.4.4")),n.createElement(se,{settings:d,onChange:y}),n.createElement("label",null,"Image format:",n.createElement(Ke,{value:b,onChange:w})),n.createElement(C.Consumer,null,(function(e){return n.createElement(A,{errors:e})}))))}function ut(e){var t=S();return n.createElement(j,null,n.createElement(P,{chainErrorHandler:t},n.createElement(it,e)))}r(1066),r(6140),document.getElementById("errors"),document.getElementById("downloader"),o.render(n.createElement(ut,null),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("sw.js",{scope:"."}).then((function(e){console.log("SW registered: ",e)})).catch((function(e){console.log("SW registration failed: ",e)}))}));var lt=document.querySelector(".add-button");lt.style.display="none",window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),tt=e,lt.style.display="block",lt.addEventListener("click",(function(){lt.style.display="none",tt.prompt(),tt.userChoice.then((function(e){"accepted"===e.outcome?console.log("User accepted the web prompt"):console.log("User dismissed the web prompt"),tt=null}))}))}))},1066:(e,t,r)=>{e.exports=r.p+"imgs\\eye162.png"},6140:(e,t,r)=>{e.exports=r.p+"manifest.webmanifest"}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={id:e,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(s=0;s<e.length;s++){for(var[r,o,a]=e[s],u=!0,l=0;l<r.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(u=!1,a<i&&(i=a));if(u){e.splice(s--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,o,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,u,l]=r,c=0;if(i.some((t=>0!==e[t]))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(l)var s=l(n)}for(t&&t(r);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[i[c]]=0;return n.O(s)},r=self.webpackChunkcontrastvisor=self.webpackChunkcontrastvisor||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var o=n.O(void 0,[216],(()=>n(186)));o=n.O(o)})();